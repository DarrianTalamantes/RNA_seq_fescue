metadata <- read.csv(paste0(data_dir, "Meta_Data/TF_DP_Mata_Data_In_progress.csv"))
colnames(metadata)[colnames(metadata) == "Sequenced_Platns"] <- "label"
###############################################################################
# Tree creation
###############################################################################
############### Same  #################
mcr50_filter_tree <- njs(mcr50_filtered_distmat)
mcr50_filter_tree$edge.length[mcr50_filter_tree$edge.length < 0] <- 1e-6
source_colors <- c(
"GTFBP" = "#F77EEB",
"TTFBP" = "#F9832F",
"Commercial"  = "#F2E782",
"France"  = "#1DB44A",
"Other"  = "#9E15BC"
)
endophyte_colors <- c(
"Positive" = "blue",
"Negative"  = "lightblue",
"NA" = "darkgrey"
)
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular")
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 0.01,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
###############################################################################
# Create a random tree with 20 tips
set.seed(123)
tree <- rtree(20)
# Create dummy metadata
metadata <- data.frame(
label = tree$tip.label,
Group = rep(c("A", "B"), 10),
Status = rep(c("Healthy", "Diseased"), each = 10)
)
# Define distinct color palettes
group_colors <- c("A" = "skyblue", "B" = "orange")
status_colors <- c("Healthy" = "forestgreen", "Diseased" = "firebrick")
# Build base tree
p <- ggtree(tree, layout = "circular")
# First annotation ring
p1 <- p +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Group),
width = 0.05
) +
scale_fill_manual(name = "Group", values = group_colors)
# Add new fill scale and second ring
p2 <- p1 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Status),
width = 0.05,
offset = 0.08  # space between rings
) +
scale_fill_manual(name = "Status", values = status_colors) +
ggtitle("Example Circular Tree with Two Annotation Rings") +
theme(legend.position = "right")
# Show the plot
p2
###############################################################################
library(ggplot2)
library(ggnewscale)
df1 <- data.frame(x = 1:5, y = 1:5, group = letters[1:5])
df2 <- data.frame(x = 1:5, y = 5:1, group = letters[1:5])
ggplot(df1, aes(x, y)) +
geom_point(aes(color = group), size = 4) +
scale_color_manual(values = c("a"="red", "b"="blue", "c"="green", "d"="purple", "e"="orange")) +
new_scale_color() +
geom_line(data = df2, aes(x, y, color = group), size = 1) +
scale_color_manual(values = c("a"="black", "b"="pink", "c"="cyan", "d"="yellow", "e"="grey"))
tree3
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular", branch.length='none')
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular")
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular")
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular")
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 0.01,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
mcr50_filter_tree <- njs(mcr50_filtered_distmat)
mcr50_filter_tree$edge.length[mcr50_filter_tree$edge.length < 0] <- 1e-6
source_colors <- c(
"GTFBP" = "#F77EEB",
"TTFBP" = "#F9832F",
"Commercial"  = "#F2E782",
"France"  = "#1DB44A",
"Other"  = "#9E15BC"
)
endophyte_colors <- c(
"Positive" = "blue",
"Negative"  = "lightblue",
"NA" = "darkgrey"
)
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular")
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 0.01,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular")
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree1
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular", branch.length='none')
tree1
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
# # Metadata
metadata <- read.csv(paste0(data_dir, "Meta_Data/TF_DP_Mata_Data_In_progress.csv"))
colnames(metadata)[colnames(metadata) == "Sequenced_Platns"] <- "label"
###############################################################################
# Tree creation
###############################################################################
############### Same  #################
mcr50_filter_tree <- njs(mcr50_filtered_distmat)
mcr50_filter_tree$edge.length[mcr50_filter_tree$edge.length < 0] <- 1e-6
source_colors <- c(
"GTFBP" = "#F77EEB",
"TTFBP" = "#F9832F",
"Commercial"  = "#F2E782",
"France"  = "#1DB44A",
"Other"  = "#9E15BC"
)
endophyte_colors <- c(
"Positive" = "blue",
"Negative"  = "lightblue",
"NA" = "darkgrey"
)
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular", branch.length='none')
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 0.01,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
tree3
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree2
tree3
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 0.01,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
#Global variables
data_dir <- "/home/darrian/Documents/Diversity_Population/Data/"
################################################################################
# Load in VCF file and create genid object and distance matrix
################################################################################
mcr50_file_filtered <- paste0(data_dir, "FreedomMarkers_Results_n_Data/VCF/Tall.fescue.202412.MCR50.snps.filtered.vcf.gz")
mcr50_filtered <- read.vcfR(mcr50_file_filtered)
mcr50_filtered_genind <- vcfR2genind(mcr50_filtered)
mcr50_filtered_distmat <- bitwise.dist(mcr50_filtered_genind, missing_match = TRUE, euclidean = FALSE)
################################################################################
# loading in metadata and distance matrixes
################################################################################
# # Metadata
metadata <- read.csv(paste0(data_dir, "Meta_Data/TF_DP_Mata_Data_In_progress.csv"))
colnames(metadata)[colnames(metadata) == "Sequenced_Platns"] <- "label"
###############################################################################
# Tree creation
###############################################################################
############### Same  #################
mcr50_filter_tree <- njs(mcr50_filtered_distmat)
mcr50_filter_tree$edge.length[mcr50_filter_tree$edge.length < 0] <- 1e-6
source_colors <- c(
"GTFBP" = "#F77EEB",
"TTFBP" = "#F9832F",
"Commercial"  = "#F2E782",
"France"  = "#1DB44A",
"Other"  = "#9E15BC"
)
endophyte_colors <- c(
"Positive" = "blue",
"Negative"  = "lightblue",
"NA" = "darkgrey"
)
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular", branch.length='none')
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 0.01,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .1,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 0.1,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = 1,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 1,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 1,
offset = 0.02,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 1,
offset = 0.05,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
# Making a tree colored by Origin
tree1 <- ggtree(mcr50_filter_tree, layout = "circular")
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = .015,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 0.01,
offset = 0.25,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
################################################################################
# Making a tree colored by Origin No Branch Length
################################################################################
tree1 <- ggtree(mcr50_filter_tree, layout = "circular", branch.length='none')
tree2 <- tree1 + geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Source),
width = 1,
)  +
scale_fill_manual(
name = "Source",
values = source_colors
)
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 1,
offset = 0.05,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right")
tree3
tree3 <- tree2 +
new_scale_fill() +
geom_fruit(
data = metadata,
geom = geom_tile,
mapping = aes(y = label, fill = Endophyte),
width = 1,
offset = 0.05,     # Placed outside the first ring
) +
scale_fill_manual(name = "Endophyte", values = endophyte_colors) +
ggtitle("Phylogenetic Tree of MCR50 Filtered Samples",) +
theme(legend.position = "right",
plot.title = element_text(hjust = 0.5))
tree3
VCFSum_dir="../../Data/FreedomMarkers_Results_n_Data/VCF_Filtered_Summary_Files/"
mcr50_depth <- paste0(VCFSum_dir,"Tall.fescue.202412.MCR50.snps.filtered.ldepth")
mcr50_depth_loc <- paste0(VCFSum_dir,"Tall.fescue.202412.MCR50.snps.filtered.ldepth")
mcr50_depth <- read.table(mcr50_depth_loc)
VCFSum_dir="../Data/FreedomMarkers_Results_n_Data/VCF_Filtered_Summary_Files/"
mcr50_depth_loc <- paste0(VCFSum_dir,"Tall.fescue.202412.MCR50.snps.filtered.ldepth")
mcr50_depth <- read.table(mcr50_depth_loc)
VCFSum_dir="../../Data/FreedomMarkers_Results_n_Data/VCF_Filtered_Summary_Files/"
mcr50_depth_loc <- paste0(VCFSum_dir,"Tall.fescue.202412.MCR50.snps.filtered.ldepth")
mcr50_depth <- read.table(mcr50_depth_loc)
mcr50_depth_loc <- paste0(VCFSum_dir,"Tall.fescue.202412.MCR50.snps.filtered.ldepth")
mcr50_depth <- read.table(mcr50_depth_loc)
